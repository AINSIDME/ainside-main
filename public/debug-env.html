<!DOCTYPE html>
<html>
<head>
    <title>Debug Environment</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #00ff00; }
        .good { color: #00ff00; }
        .bad { color: #ff0000; }
        pre { background: #000; padding: 10px; border: 1px solid #00ff00; }
    </style>
</head>
<body>
    <h1>Debug: Verificando configuración de Supabase</h1>
    <div id="output"></div>
    
    <script type="module">
        const output = document.getElementById('output');
        
        function log(msg, isGood = true) {
            const div = document.createElement('div');
            div.className = isGood ? 'good' : 'bad';
            div.textContent = msg;
            output.appendChild(div);
        }
        
        log('=== INICIANDO DEBUG ===');
        log('');
        
        // Test 1: Verificar si los módulos se pueden importar
        try {
            const module = await import('/src/integrations/supabase/client.ts');
            log('✅ Módulo supabase importado correctamente');
            
            // Test 2: Verificar el cliente
            if (module.supabase) {
                log('✅ Cliente Supabase existe');
                
                // Test 3: Verificar la URL
                const supabaseUrl = module.supabase.supabaseUrl;
                log('URL Supabase: ' + supabaseUrl);
                
                // Test 4: Verificar el key (últimos 10 caracteres)
                const supabaseKey = module.supabase.supabaseKey;
                if (supabaseKey) {
                    log('✅ Anon Key detectada');
                    log('Últimos 10 caracteres: ...' + supabaseKey.slice(-10));
                    
                    if (supabaseKey.slice(-10) === 'ujdcB-xLA') {
                        log('✅ ¡KEY CORRECTA! (termina en ...ujdcB-xLA)', true);
                    } else {
                        log('❌ KEY INCORRECTA! Termina en: ' + supabaseKey.slice(-10), false);
                        log('Debería terminar en: ...ujdcB-xLA', false);
                    }
                } else {
                    log('❌ No se pudo leer el anon key', false);
                }
                
                // Test 5: Probar una llamada simple
                log('');
                log('Probando conexión...');
                try {
                    const { data, error } = await module.supabase.auth.getSession();
                    if (error) {
                        log('Error en getSession: ' + error.message, false);
                    } else {
                        log('✅ Conexión exitosa a Supabase Auth');
                    }
                } catch (err) {
                    log('❌ Error al conectar: ' + err.message, false);
                }
                
            } else {
                log('❌ Cliente Supabase no existe', false);
            }
            
        } catch (err) {
            log('❌ Error al importar módulo: ' + err.message, false);
            log('Stack: ' + err.stack, false);
        }
        
        log('');
        log('=== DEBUG COMPLETO ===');
    </script>
</body>
</html>
